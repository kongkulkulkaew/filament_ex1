# Customer CRUD - р╕Бр╕▓р╕гр╕Ьр╕кр╕б Filament р╕Бр╕▒р╕Ъ Custom Code

## ЁЯУЛ р╕кр╕▓р╕гр╕Ър╕▒р╕Н

1. [р╕ар╕▓р╕Юр╕гр╕зр╕б](#р╕ар╕▓р╕Юр╕гр╕зр╕б)
2. [р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М](#р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М)
3. [р╕Бр╕▓р╕гр╕Чр╕│р╕Зр╕▓р╕Щр╕Вр╕нр╕Зр╣Бр╕Хр╣Ир╕ер╕░р╕кр╣Ир╕зр╕Щ](#р╕Бр╕▓р╕гр╕Чр╕│р╕Зр╕▓р╕Щр╕Вр╕нр╕Зр╣Бр╕Хр╣Ир╕ер╕░р╕кр╣Ир╕зр╕Щ)
4. [Custom Logic р╕Чр╕╡р╣Ир╣Ар╕Вр╕╡р╕вр╕Щр╣Ар╕нр╕З](#custom-logic-р╕Чр╕╡р╣Ир╣Ар╕Вр╕╡р╕вр╕Щр╣Ар╕нр╕З)
5. [р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ](#р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ)

---

## ЁЯОп р╕ар╕▓р╕Юр╕гр╕зр╕б

CRUD р╕ер╕╣р╕Бр╕Др╣Йр╕▓р╕Щр╕╡р╣Йр╣Бр╕кр╕Фр╕Зр╣Гр╕лр╣Йр╣Ар╕лр╣Зр╕Щр╕Бр╕▓р╕г**р╕Ьр╕кр╕бр╕гр╕░р╕лр╕зр╣Ир╕▓р╕З Filament features р╕Бр╕▒р╕Ъ custom code р╕Чр╕╡р╣Ир╣Ар╕Вр╕╡р╕вр╕Щр╣Ар╕нр╕З** р╣Вр╕Фр╕в:

- **р╣Гр╕Кр╣Й Filament Components** р╕кр╕│р╕лр╕гр╕▒р╕Ъ UI р╣Бр╕ер╕░ CRUD р╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щ
- **р╣Ар╕Вр╕╡р╕вр╕Щ Custom Logic** р╕кр╕│р╕лр╕гр╕▒р╕Ъ business rules р╣Бр╕ер╕░ validation
- **р╣Ар╕Юр╕┤р╣Ир╕б Custom Actions** р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Яр╕╡р╣Ар╕Ир╕нр╕гр╣Мр╕Юр╕┤р╣Ар╕ир╕й
- **р╣Ар╕Юр╕┤р╣Ир╕б Custom Methods** р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕ер╕Вр╣Йр╕нр╕бр╕╣р╕е

---

## ЁЯУБ р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М

```
app/Filament/Resources/Customers/
тФЬтФАтФА CustomerResource.php          # Resource р╕лр╕ер╕▒р╕Б
тФЬтФАтФА Schemas/
тФВ   тФФтФАтФА CustomerForm.php          # Form Schema (Filament + Custom Logic)
тФЬтФАтФА Tables/
тФВ   тФФтФАтФА CustomersTable.php        # Table Schema (Filament + Custom Actions)
тФФтФАтФА Pages/
    тФЬтФАтФА ListCustomers.php         # р╕лр╕Щр╣Йр╕▓ List (Filament + Custom Actions)
    тФЬтФАтФА CreateCustomer.php        # р╕лр╕Щр╣Йр╕▓р╕кр╕гр╣Йр╕▓р╕З (Filament + Custom Logic)
    тФФтФАтФА EditCustomer.php          # р╕лр╕Щр╣Йр╕▓р╣Бр╕Бр╣Йр╣Др╕В (Filament + Custom Validation)
```

---

## ЁЯФз р╕Бр╕▓р╕гр╕Чр╕│р╕Зр╕▓р╕Щр╕Вр╕нр╕Зр╣Бр╕Хр╣Ир╕ер╕░р╕кр╣Ир╕зр╕Щ

### 1. CustomerResource.php

**р╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣И:** Resource р╕лр╕ер╕▒р╕Бр╕Чр╕╡р╣Ир╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╕Чр╕╕р╕Бр╕кр╣Ир╕зр╕Щр╣Ар╕Вр╣Йр╕▓р╕Фр╣Йр╕зр╕вр╕Бр╕▒р╕Щ

**Filament Features:**
- `form()` - р╕Бр╕│р╕лр╕Щр╕Ф Form Schema
- `table()` - р╕Бр╕│р╕лр╕Щр╕Ф Table Schema
- `getPages()` - р╕Бр╕│р╕лр╕Щр╕Ф Pages

**Custom Code:**
- р╣Др╕бр╣Ир╕бр╕╡ (р╣Ар╕Ыр╣Зр╕Щр╣Бр╕Др╣И connector)

```php
public static function form(Schema $schema): Schema
{
    return CustomerForm::configure($schema); // р╣Ар╕гр╕╡р╕вр╕Бр╣Гр╕Кр╣Й Form Schema
}

public static function table(Table $table): Table
{
    return CustomersTable::configure($table); // р╣Ар╕гр╕╡р╕вр╕Бр╣Гр╕Кр╣Й Table Schema
}
```

---

### 2. CustomerForm.php (Schemas)

**р╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣И:** р╕Бр╕│р╕лр╕Щр╕Ф Form Components р╣Бр╕ер╕░ Custom Logic

**Filament Features:**
- `TextInput`, `Textarea`, `Section` - Form Components
- `->live()` - Real-time updates
- `->afterStateUpdated()` - Hook р╣Ар╕бр╕╖р╣Ир╕нр╕Др╣Ир╕▓р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щ

**Custom Logic р╕Чр╕╡р╣Ир╣Ар╕Вр╕╡р╕вр╕Щр╣Ар╕нр╕З:**

#### 2.1 Custom Logic: р╣Бр╕Ыр╕ер╕Зр╕Кр╕╖р╣Ир╕нр╣Ар╕Ыр╣Зр╕Щр╕Хр╕▒р╕зр╕Юр╕┤р╕бр╕Юр╣Мр╣Гр╕лр╕Нр╣Ир╕Хр╕▒р╕зр╣Бр╕гр╕Б

```php
TextInput::make('name')
    ->afterStateUpdated(function ($state, callable $set) {
        // Custom logic: р╣Бр╕Ыр╕ер╕Зр╕Кр╕╖р╣Ир╕нр╣Ар╕Ыр╣Зр╕Щр╕Хр╕▒р╕зр╕Юр╕┤р╕бр╕Юр╣Мр╣Гр╕лр╕Нр╣Ир╕Хр╕▒р╕зр╣Бр╕гр╕Б
        if ($state) {
            $set('name', mb_convert_case($state, MB_CASE_TITLE, 'UTF-8'));
        }
    })
```

**р╕нр╕Шр╕┤р╕Ър╕▓р╕в:**
- р╣Ар╕бр╕╖р╣Ир╕нр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕Юр╕┤р╕бр╕Юр╣Мр╕Кр╕╖р╣Ир╕н `->afterStateUpdated()` р╕Ир╕░р╕Цр╕╣р╕Бр╣Ар╕гр╕╡р╕вр╕Б
- р╣Гр╕Кр╣Й `mb_convert_case()` р╣Ар╕Юр╕╖р╣Ир╕нр╣Бр╕Ыр╕ер╕Зр╕Кр╕╖р╣Ир╕нр╣Ар╕Ыр╣Зр╕Щр╕Хр╕▒р╕зр╕Юр╕┤р╕бр╕Юр╣Мр╣Гр╕лр╕Нр╣Ир╕Хр╕▒р╕зр╣Бр╕гр╕Б
- р╣Гр╕Кр╣Й `$set()` р╣Ар╕Юр╕╖р╣Ир╕нр╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╕Др╣Ир╕▓р╣Гр╕Щ form

#### 2.2 Custom Logic: р╣Бр╕Ыр╕ер╕Зр╕нр╕╡р╣Ар╕бр╕ер╣Ар╕Ыр╣Зр╕Щр╕Хр╕▒р╕зр╕Юр╕┤р╕бр╕Юр╣Мр╣Ар╕ер╣Зр╕Б

```php
TextInput::make('email')
    ->afterStateUpdated(function ($state, callable $set) {
        // Custom logic: р╣Бр╕Ыр╕ер╕Зр╕нр╕╡р╣Ар╕бр╕ер╣Ар╕Ыр╣Зр╕Щр╕Хр╕▒р╕зр╕Юр╕┤р╕бр╕Юр╣Мр╣Ар╕ер╣Зр╕Б
        if ($state) {
            $set('email', strtolower($state));
        }
    })
```

**р╕нр╕Шр╕┤р╕Ър╕▓р╕в:**
- р╣Ар╕бр╕╖р╣Ир╕нр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕Юр╕┤р╕бр╕Юр╣Мр╕нр╕╡р╣Ар╕бр╕е р╕Ир╕░р╣Бр╕Ыр╕ер╕Зр╣Ар╕Ыр╣Зр╕Щр╕Хр╕▒р╕зр╕Юр╕┤р╕бр╕Юр╣Мр╣Ар╕ер╣Зр╕Бр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤
- р╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╕Бр╕▓р╕гр╕Лр╣Йр╕│р╕Лр╣Йр╕нр╕Щр╕Вр╕нр╕Зр╕нр╕╡р╣Ар╕бр╕е (р╣Ар╕Кр╣Ир╕Щ `Test@Email.com` р╣Бр╕ер╕░ `test@email.com`)

#### 2.3 Custom Logic: р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Ар╕Ър╕нр╕гр╣Мр╣Вр╕Чр╕гр╣Др╕Чр╕в

```php
TextInput::make('phone')
    ->afterStateUpdated(function ($state, callable $set) {
        // Custom logic: р╕ер╕Ър╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕лр╕бр╕▓р╕вр╕Вр╕╡р╕Фр╕нр╕нр╕Бр╣Ар╕Юр╕╖р╣Ир╕нр╣Ар╕Бр╣Зр╕Ър╣Гр╕Щ database
        if ($state) {
            $cleanPhone = str_replace('-', '', $state);
            // р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╣Ар╕Ыр╣Зр╕Щр╣Ар╕Ър╕нр╕гр╣Мр╣Вр╕Чр╕гр╣Др╕Чр╕вр╕лр╕гр╕╖р╕нр╣Др╕бр╣И
            if (preg_match('/^0[689]\d{8}$/', $cleanPhone)) {
                // р╣Ар╕Ър╕нр╕гр╣Мр╣Вр╕Чр╕гр╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З
            }
        }
    })
```

**р╕нр╕Шр╕┤р╕Ър╕▓р╕в:**
- р╣Бр╕кр╕Фр╕Зр╕Ьр╕ер╣Бр╕Ър╕Ър╕бр╕╡р╕Вр╕╡р╕Ф (08X-XXX-XXXX) р╣Бр╕Хр╣Ир╣Ар╕Бр╣Зр╕Ър╣Гр╕Щ database р╣Бр╕Ър╕Ър╣Др╕бр╣Ир╕бр╕╡р╕Вр╕╡р╕Ф
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╣Ар╕Ыр╣Зр╕Щр╣Ар╕Ър╕нр╕гр╣Мр╣Вр╕Чр╕гр╣Др╕Чр╕вр╕лр╕гр╕╖р╕нр╣Др╕бр╣Ир╕Фр╣Йр╕зр╕в regex

---

### 3. CustomersTable.php (Tables)

**р╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣И:** р╕Бр╕│р╕лр╕Щр╕Ф Table Columns, Filters, р╣Бр╕ер╕░ Actions

**Filament Features:**
- `TextColumn`, `IconColumn` - Table Columns
- `Filter`, `SelectFilter` - Table Filters
- `EditAction`, `DeleteAction` - Record Actions
- `BulkActionGroup` - Bulk Actions

**Custom Logic р╕Чр╕╡р╣Ир╣Ар╕Вр╕╡р╕вр╕Щр╣Ар╕нр╕З:**

#### 3.1 Custom Query: Eager Load Orders

```php
->modifyQueryUsing(function (Builder $query) {
    // Custom query: eager load orders р╣Ар╕Юр╕╖р╣Ир╕нр╕ер╕Ф N+1 queries
    return $query->withCount('orders');
})
```

**р╕нр╕Шр╕┤р╕Ър╕▓р╕в:**
- р╣Гр╕Кр╣Й `withCount('orders')` р╣Ар╕Юр╕╖р╣Ир╕нр╕Щр╕▒р╕Ър╕Ир╕│р╕Щр╕зр╕Щр╕нр╕нр╣Ар╕Фр╕нр╕гр╣Мр╕Вр╕нр╕Зр╣Бр╕Хр╣Ир╕ер╕░р╕ер╕╣р╕Бр╕Др╣Йр╕▓
- р╕ер╕Ф N+1 queries р╣Ар╕бр╕╖р╣Ир╕нр╣Бр╕кр╕Фр╕Зр╕Ир╕│р╕Щр╕зр╕Щр╕нр╕нр╣Ар╕Фр╕нр╕гр╣М

#### 3.2 Custom Column: р╣Бр╕кр╕Фр╕Зр╕Ир╕│р╕Щр╕зр╕Щр╕нр╕нр╣Ар╕Фр╕нр╕гр╣М

```php
TextColumn::make('orders_count')
    ->label('р╕Ир╕│р╕Щр╕зр╕Щр╕нр╕нр╣Ар╕Фр╕нр╕гр╣М')
    ->counts('orders')
    ->badge()
    ->color(fn ($state) => $state > 0 ? 'success' : 'gray')
    ->formatStateUsing(fn ($state) => $state . ' р╕нр╕нр╣Ар╕Фр╕нр╕гр╣М')
```

**р╕нр╕Шр╕┤р╕Ър╕▓р╕в:**
- р╣Гр╕Кр╣Й `->counts('orders')` р╣Ар╕Юр╕╖р╣Ир╕нр╕Щр╕▒р╕Ър╕Ир╕│р╕Щр╕зр╕Щр╕нр╕нр╣Ар╕Фр╕нр╕гр╣М
- р╣Гр╕Кр╣Й `->badge()` р╣Ар╕Юр╕╖р╣Ир╕нр╣Бр╕кр╕Фр╕Зр╣Ар╕Ыр╣Зр╕Щ badge
- р╣Гр╕Кр╣Й `->color()` р╣Ар╕Юр╕╖р╣Ир╕нр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╕кр╕╡р╕Хр╕▓р╕бр╕Ир╕│р╕Щр╕зр╕Щр╕нр╕нр╣Ар╕Фр╕нр╕гр╣М
- р╣Гр╕Кр╣Й `->formatStateUsing()` р╣Ар╕Юр╕╖р╣Ир╕нр╕Ир╕▒р╕Фр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б

#### 3.3 Custom Action: р╕ер╕Ър╕Юр╕гр╣Йр╕нр╕бр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕нр╕нр╣Ар╕Фр╕нр╕гр╣М

```php
DeleteAction::make()
    ->action(function ($record) {
        // Custom logic: р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕бр╕╡р╕нр╕нр╣Ар╕Фр╕нр╕гр╣Мр╕лр╕гр╕╖р╕нр╣Др╕бр╣И
        if ($record->orders()->exists()) {
            \Filament\Notifications\Notification::make()
                ->title('р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕ер╕Ър╣Др╕Фр╣Й')
                ->body('р╕ер╕╣р╕Бр╕Др╣Йр╕▓р╕Щр╕╡р╣Йр╕бр╕╡р╕нр╕нр╣Ар╕Фр╕нр╕гр╣Мр╕нр╕вр╕╣р╣И р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕ер╕Ър╣Др╕Фр╣Й')
                ->danger()
                ->send();
            return;
        }

        // р╕ер╕Ър╕ер╕╣р╕Бр╕Др╣Йр╕▓
        $record->delete();
    })
```

**р╕нр╕Шр╕┤р╕Ър╕▓р╕в:**
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕ер╕╣р╕Бр╕Др╣Йр╕▓р╕бр╕╡р╕нр╕нр╣Ар╕Фр╕нр╕гр╣Мр╕лр╕гр╕╖р╕нр╣Др╕бр╣Ир╕Бр╣Ир╕нр╕Щр╕ер╕Ъ
- р╕Цр╣Йр╕▓р╕бр╕╡р╕нр╕нр╣Ар╕Фр╕нр╕гр╣М р╕Ир╕░р╣Бр╕кр╕Фр╕З notification р╣Бр╕ер╕░р╣Др╕бр╣Ир╕ер╕Ъ
- р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╕бр╕╡р╕нр╕нр╣Ар╕Фр╕нр╕гр╣М р╕Ир╕░р╕ер╕Ър╣Др╕Фр╣Й

#### 3.4 Custom Bulk Action: р╕кр╣Ир╕Зр╕нр╕╡р╣Ар╕бр╕е

```php
\Filament\Actions\Action::make('send_email')
    ->action(function (Collection $records) {
        // Custom logic: р╕кр╣Ир╕Зр╕нр╕╡р╣Ар╕бр╕ер╣Гр╕лр╣Йр╕ер╕╣р╕Бр╕Др╣Йр╕▓р╕Чр╕╡р╣Ир╣Ар╕ер╕╖р╕нр╕Б
        $emails = $records->pluck('email')->toArray();
        
        \Filament\Notifications\Notification::make()
            ->title('р╕кр╣Ир╕Зр╕нр╕╡р╣Ар╕бр╕е')
            ->body('р╕кр╣Ир╕Зр╕нр╕╡р╣Ар╕бр╕ер╣Гр╕лр╣Йр╕ер╕╣р╕Бр╕Др╣Йр╕▓ ' . count($emails) . ' р╕гр╕▓р╕вр╕Бр╕▓р╕г')
            ->success()
            ->send();
    })
```

**р╕нр╕Шр╕┤р╕Ър╕▓р╕в:**
- р╣Ар╕ер╕╖р╕нр╕Бр╕ер╕╣р╕Бр╕Др╣Йр╕▓р╕лр╕ер╕▓р╕вр╕гр╕▓р╕вр╕Бр╕▓р╕гр╣Бр╕ер╣Йр╕зр╕кр╣Ир╕Зр╕нр╕╡р╣Ар╕бр╕ер╕Юр╕гр╣Йр╕нр╕бр╕Бр╕▒р╕Щ
- р╣Гр╕Кр╣Й `pluck('email')` р╣Ар╕Юр╕╖р╣Ир╕нр╕Фр╕╢р╕Зр╕нр╕╡р╣Ар╕бр╕ер╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф
- р╣Бр╕кр╕Фр╕З notification р╣Ар╕бр╕╖р╣Ир╕нр╕кр╣Ир╕Зр╕кр╕│р╣Ар╕гр╣Зр╕И

---

### 4. ListCustomers.php (Pages)

**р╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣И:** р╕лр╕Щр╣Йр╕▓р╣Бр╕кр╕Фр╕Зр╕гр╕▓р╕вр╕Бр╕▓р╕гр╕ер╕╣р╕Бр╕Др╣Йр╕▓

**Filament Features:**
- `ListRecords` - Base class р╕кр╕│р╕лр╕гр╕▒р╕Ъ list page
- `CreateAction` - Action р╕кр╕гр╣Йр╕▓р╕Зр╣Гр╕лр╕бр╣И

**Custom Actions р╕Чр╕╡р╣Ир╣Ар╕Вр╕╡р╕вр╕Щр╣Ар╕нр╕З:**

#### 4.1 Custom Action: р╕кр╣Ир╕Зр╕нр╕нр╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕е

```php
Action::make('export')
    ->label('р╕кр╣Ир╕Зр╕нр╕нр╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕е')
    ->action(function () {
        // Custom logic: р╕кр╣Ир╕Зр╕нр╕нр╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕ер╕╣р╕Бр╕Др╣Йр╕▓
        $customers = \App\Models\Customer::all();
        
        \Filament\Notifications\Notification::make()
            ->title('р╕кр╣Ир╕Зр╕нр╕нр╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕е')
            ->body('р╕кр╣Ир╕Зр╕нр╕нр╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕ер╕╣р╕Бр╕Др╣Йр╕▓ ' . $customers->count() . ' р╕гр╕▓р╕вр╕Бр╕▓р╕г')
            ->success()
            ->send();
    })
```

**р╕нр╕Шр╕┤р╕Ър╕▓р╕в:**
- р╕кр╕гр╣Йр╕▓р╕З action р╕кр╕│р╕лр╕гр╕▒р╕Ър╕кр╣Ир╕Зр╕нр╕нр╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕ер╕╣р╕Бр╕Др╣Йр╕▓
- р╣Гр╕Щр╣Вр╕Ыр╕гр╣Ар╕Ир╕Др╕Ир╕гр╕┤р╕Зр╕Др╕зр╕гр╕кр╣Ир╕Зр╕нр╕нр╕Бр╣Ар╕Ыр╣Зр╕Щ CSV р╕лр╕гр╕╖р╕н Excel

#### 4.2 Custom Action: р╕кр╕Цр╕┤р╕Хр╕┤р╕ер╕╣р╕Бр╕Др╣Йр╕▓

```php
Action::make('statistics')
    ->modalContent(function () {
        // Custom logic: р╕Др╕│р╕Щр╕зр╕Ур╕кр╕Цр╕┤р╕Хр╕┤
        $totalCustomers = \App\Models\Customer::count();
        $customersWithOrders = \App\Models\Customer::has('orders')->count();
        // ...
        
        return view('filament.resources.customers.statistics', [
            'totalCustomers' => $totalCustomers,
            // ...
        ]);
    })
```

**р╕нр╕Шр╕┤р╕Ър╕▓р╕в:**
- р╕кр╕гр╣Йр╕▓р╕З modal р╣Ар╕Юр╕╖р╣Ир╕нр╣Бр╕кр╕Фр╕Зр╕кр╕Цр╕┤р╕Хр╕┤р╕ер╕╣р╕Бр╕Др╣Йр╕▓
- р╕Др╕│р╕Щр╕зр╕Ур╕кр╕Цр╕┤р╕Хр╕┤р╕Фр╣Йр╕зр╕в custom queries
- р╣Бр╕кр╕Фр╕Зр╕Ьр╕ер╕Фр╣Йр╕зр╕в custom view

---

### 5. CreateCustomer.php (Pages)

**р╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣И:** р╕лр╕Щр╣Йр╕▓р╕кр╕гр╣Йр╕▓р╕Зр╕ер╕╣р╕Бр╕Др╣Йр╕▓р╣Гр╕лр╕бр╣И

**Filament Features:**
- `CreateRecord` - Base class р╕кр╕│р╕лр╕гр╕▒р╕Ъ create page
- `mutateFormDataBeforeCreate()` - Hook р╕Бр╣Ир╕нр╕Щр╕кр╕гр╣Йр╕▓р╕З
- `afterCreate()` - Hook р╕лр╕ер╕▒р╕Зр╕кр╕гр╣Йр╕▓р╕З

**Custom Logic р╕Чр╕╡р╣Ир╣Ар╕Вр╕╡р╕вр╕Щр╣Ар╕нр╕З:**

#### 5.1 Custom Logic: р╕кр╕гр╣Йр╕▓р╕Зр╕гр╕лр╕▒р╕кр╕ер╕╣р╕Бр╕Др╣Йр╕▓р╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤

```php
protected function mutateFormDataBeforeCreate(array $data): array
{
    // Custom logic: р╕кр╕гр╣Йр╕▓р╕З customer code р╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤
    $data['customer_code'] = $this->generateCustomerCode();
    
    return $data;
}

protected function generateCustomerCode(): string
{
    // Custom logic: р╕кр╕гр╣Йр╕▓р╕Зр╕гр╕лр╕▒р╕кр╕ер╕╣р╕Бр╕Др╣Йр╕▓р╣Бр╕Ър╕Ъ CUS-000001
    $lastCustomer = Customer::orderBy('id', 'desc')->first();
    $nextId = $lastCustomer ? $lastCustomer->id + 1 : 1;
    
    return 'CUS-' . str_pad((string) $nextId, 6, '0', STR_PAD_LEFT);
}
```

**р╕нр╕Шр╕┤р╕Ър╕▓р╕в:**
- р╕кр╕гр╣Йр╕▓р╕Зр╕гр╕лр╕▒р╕кр╕ер╕╣р╕Бр╕Др╣Йр╕▓р╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤р╕Бр╣Ир╕нр╕Щр╕Ър╕▒р╕Щр╕Чр╕╢р╕Б
- р╕гр╕╣р╕Ыр╣Бр╕Ър╕Ъ: `CUS-000001`, `CUS-000002`, ...
- р╣Гр╕Кр╣Й `generateCustomerCode()` method р╕Чр╕╡р╣Ир╣Ар╕Вр╕╡р╕вр╕Щр╣Ар╕нр╕З

#### 5.2 Custom Logic: р╕Ър╕▒р╕Щр╕Чр╕╢р╕Б Log

```php
protected function afterCreate(): void
{
    $customer = $this->record;
    
    // Custom logic: р╕Ър╕▒р╕Щр╕Чр╕╢р╕Б log
    \Log::info('р╕кр╕гр╣Йр╕▓р╕Зр╕ер╕╣р╕Бр╕Др╣Йр╕▓р╣Гр╕лр╕бр╣И: ' . $customer->name, [
        'customer_id' => $customer->id,
        'email' => $customer->email,
    ]);
}
```

**р╕нр╕Шр╕┤р╕Ър╕▓р╕в:**
- р╕Ър╕▒р╕Щр╕Чр╕╢р╕Б log р╕лр╕ер╕▒р╕Зр╕Ир╕▓р╕Бр╕кр╕гр╣Йр╕▓р╕Зр╕ер╕╣р╕Бр╕Др╣Йр╕▓р╣Гр╕лр╕бр╣И
- р╣Ар╕Бр╣Зр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╕кр╕│р╕Др╕▒р╕Нр╣Др╕зр╣Йр╣Гр╕Щ log

---

### 6. EditCustomer.php (Pages)

**р╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣И:** р╕лр╕Щр╣Йр╕▓р╣Бр╕Бр╣Йр╣Др╕Вр╕ер╕╣р╕Бр╕Др╣Йр╕▓

**Filament Features:**
- `EditRecord` - Base class р╕кр╕│р╕лр╕гр╕▒р╕Ъ edit page
- `mutateFormDataBeforeSave()` - Hook р╕Бр╣Ир╕нр╕Щр╕Ър╕▒р╕Щр╕Чр╕╢р╕Б
- `afterSave()` - Hook р╕лр╕ер╕▒р╕Зр╕Ър╕▒р╕Щр╕Чр╕╢р╕Б

**Custom Logic р╕Чр╕╡р╣Ир╣Ар╕Вр╕╡р╕вр╕Щр╣Ар╕нр╕З:**

#### 6.1 Custom Validation: р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕нр╕╡р╣Ар╕бр╕ер╕Лр╣Йр╕│

```php
protected function mutateFormDataBeforeSave(array $data): array
{
    // Custom logic: р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕нр╕╡р╣Ар╕бр╕ер╕Лр╣Йр╕│ (р╕вр╕Бр╣Ар╕зр╣Йр╕Щр╕Хр╕▒р╕зр╣Ар╕нр╕З)
    if (isset($data['email'])) {
        $existingCustomer = Customer::where('email', $data['email'])
            ->where('id', '!=', $this->record->id)
            ->first();
        
        if ($existingCustomer) {
            throw ValidationException::withMessages([
                'email' => 'р╕нр╕╡р╣Ар╕бр╕ер╕Щр╕╡р╣Йр╕Цр╕╣р╕Бр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╣Бр╕ер╣Йр╕зр╣Вр╕Фр╕вр╕ер╕╣р╕Бр╕Др╣Йр╕▓р╕нр╕╖р╣Ир╕Щ',
            ]);
        }
    }
    
    return $data;
}
```

**р╕нр╕Шр╕┤р╕Ър╕▓р╕в:**
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕нр╕╡р╣Ар╕бр╕ер╕Лр╣Йр╕│р╕Бр╕▒р╕Ър╕ер╕╣р╕Бр╕Др╣Йр╕▓р╕нр╕╖р╣Ир╕Щр╕лр╕гр╕╖р╕нр╣Др╕бр╣И (р╕вр╕Бр╣Ар╕зр╣Йр╕Щр╕Хр╕▒р╕зр╣Ар╕нр╕З)
- р╕Цр╣Йр╕▓р╕Лр╣Йр╕│ р╕Ир╕░ throw `ValidationException`
- Filament р╕Ир╕░р╣Бр╕кр╕Фр╕З error message р╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤

#### 6.2 Custom Action: р╕Фр╕╣р╕нр╕нр╣Ар╕Фр╕нр╕гр╣Мр╕Вр╕нр╕Зр╕ер╕╣р╕Бр╕Др╣Йр╕▓

```php
Action::make('view_orders')
    ->url(fn () => \App\Filament\Resources\Orders\OrderResource::getUrl('index', [
        'tableFilters' => [
            'customer_id' => [
                'value' => $this->record->id,
            ],
        ],
    ]))
    ->visible(fn () => $this->record->orders()->exists())
```

**р╕нр╕Шр╕┤р╕Ър╕▓р╕в:**
- р╕кр╕гр╣Йр╕▓р╕З action р╣Ар╕Юр╕╖р╣Ир╕нр╣Др╕Ыр╕Фр╕╣р╕нр╕нр╣Ар╕Фр╕нр╕гр╣Мр╕Вр╕нр╕Зр╕ер╕╣р╕Бр╕Др╣Йр╕▓
- р╣Гр╕Кр╣Й `->url()` р╣Ар╕Юр╕╖р╣Ир╕нр╕Бр╕│р╕лр╕Щр╕Ф URL
- р╣Гр╕Кр╣Й `->visible()` р╣Ар╕Юр╕╖р╣Ир╕нр╣Бр╕кр╕Фр╕Зр╣Ар╕Йр╕Юр╕▓р╕░р╣Ар╕бр╕╖р╣Ир╕нр╕бр╕╡р╕нр╕нр╣Ар╕Фр╕нр╕гр╣М

---

## ЁЯОи Custom Logic р╕Чр╕╡р╣Ир╣Ар╕Вр╕╡р╕вр╕Щр╣Ар╕нр╕З

### р╕кр╕гр╕╕р╕Ы Custom Logic р╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф:

1. **Form Logic:**
   - р╣Бр╕Ыр╕ер╕Зр╕Кр╕╖р╣Ир╕нр╣Ар╕Ыр╣Зр╕Щр╕Хр╕▒р╕зр╕Юр╕┤р╕бр╕Юр╣Мр╣Гр╕лр╕Нр╣Ир╕Хр╕▒р╕зр╣Бр╕гр╕Б
   - р╣Бр╕Ыр╕ер╕Зр╕нр╕╡р╣Ар╕бр╕ер╣Ар╕Ыр╣Зр╕Щр╕Хр╕▒р╕зр╕Юр╕┤р╕бр╕Юр╣Мр╣Ар╕ер╣Зр╕Б
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Ар╕Ър╕нр╕гр╣Мр╣Вр╕Чр╕гр╣Др╕Чр╕в

2. **Table Logic:**
   - Eager load orders р╣Ар╕Юр╕╖р╣Ир╕нр╕ер╕Ф N+1 queries
   - р╣Бр╕кр╕Фр╕Зр╕Ир╕│р╕Щр╕зр╕Щр╕нр╕нр╣Ар╕Фр╕нр╕гр╣Мр╣Ар╕Ыр╣Зр╕Щ badge
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕нр╕нр╣Ар╕Фр╕нр╕гр╣Мр╕Бр╣Ир╕нр╕Щр╕ер╕Ъ

3. **Create Logic:**
   - р╕кр╕гр╣Йр╕▓р╕Зр╕гр╕лр╕▒р╕кр╕ер╕╣р╕Бр╕Др╣Йр╕▓р╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤
   - р╕Ър╕▒р╕Щр╕Чр╕╢р╕Б log
   - р╕кр╣Ир╕З notification

4. **Edit Logic:**
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕нр╕╡р╣Ар╕бр╕ер╕Лр╣Йр╕│
   - р╕Ър╕▒р╕Щр╕Чр╕╢р╕Б log
   - р╕кр╣Ир╕З notification

5. **Custom Actions:**
   - р╕кр╣Ир╕Зр╕нр╕нр╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕е
   - р╕Щр╕│р╣Ар╕Вр╣Йр╕▓р╕Вр╣Йр╕нр╕бр╕╣р╕е
   - р╣Бр╕кр╕Фр╕Зр╕кр╕Цр╕┤р╕Хр╕┤
   - р╕Фр╕╣р╕нр╕нр╣Ар╕Фр╕нр╕гр╣М
   - р╕кр╕гр╣Йр╕▓р╕Зр╕нр╕нр╣Ар╕Фр╕нр╕гр╣Мр╣Гр╕лр╕бр╣И
   - р╕кр╣Ир╕Зр╕нр╕╡р╣Ар╕бр╕е (bulk)

---

## ЁЯТб р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

### 1. р╕кр╕гр╣Йр╕▓р╕Зр╕ер╕╣р╕Бр╕Др╣Йр╕▓р╣Гр╕лр╕бр╣И

1. р╣Др╕Ыр╕Чр╕╡р╣Ир╕лр╕Щр╣Йр╕▓ "р╕ер╕╣р╕Бр╕Др╣Йр╕▓" тЖТ р╕Бр╕Ф "р╕кр╕гр╣Йр╕▓р╕Зр╕ер╕╣р╕Бр╕Др╣Йр╕▓р╣Гр╕лр╕бр╣И"
2. р╕Бр╕гр╕нр╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕е:
   - **р╕Кр╕╖р╣Ир╕н:** `р╕кр╕бр╕Кр╕▓р╕в р╣Гр╕Ир╕Фр╕╡` тЖТ р╕Ир╕░р╣Бр╕Ыр╕ер╕Зр╣Ар╕Ыр╣Зр╕Щ `р╕кр╕бр╕Кр╕▓р╕в р╣Гр╕Ир╕Фр╕╡` р╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤
   - **р╕нр╕╡р╣Ар╕бр╕е:** `Test@Email.com` тЖТ р╕Ир╕░р╣Бр╕Ыр╕ер╕Зр╣Ар╕Ыр╣Зр╕Щ `test@email.com` р╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤
   - **р╣Ар╕Ър╕нр╕гр╣Мр╣Вр╕Чр╕г:** `081-234-5678` тЖТ р╕Ир╕░р╣Ар╕Бр╣Зр╕Ър╣Ар╕Ыр╣Зр╕Щ `0812345678` р╣Гр╕Щ database
3. р╕Бр╕Ф "р╕кр╕гр╣Йр╕▓р╕З" тЖТ р╕Ир╕░р╕кр╕гр╣Йр╕▓р╕Зр╕гр╕лр╕▒р╕кр╕ер╕╣р╕Бр╕Др╣Йр╕▓р╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤ (р╣Ар╕Кр╣Ир╕Щ `CUS-000001`)

### 2. р╣Бр╕Бр╣Йр╣Др╕Вр╕ер╕╣р╕Бр╕Др╣Йр╕▓

1. р╣Др╕Ыр╕Чр╕╡р╣Ир╕лр╕Щр╣Йр╕▓ "р╕ер╕╣р╕Бр╕Др╣Йр╕▓" тЖТ р╕Бр╕Ф "р╣Бр╕Бр╣Йр╣Др╕В" р╕Чр╕╡р╣Ир╕ер╕╣р╕Бр╕Др╣Йр╕▓р╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕г
2. р╣Бр╕Бр╣Йр╣Др╕Вр╕Вр╣Йр╕нр╕бр╕╣р╕е тЖТ р╕Бр╕Ф "р╕Ър╕▒р╕Щр╕Чр╕╢р╕Б"
3. р╕Цр╣Йр╕▓р╕нр╕╡р╣Ар╕бр╕ер╕Лр╣Йр╕│р╕Бр╕▒р╕Ър╕ер╕╣р╕Бр╕Др╣Йр╕▓р╕нр╕╖р╣Ир╕Щ тЖТ р╕Ир╕░р╣Бр╕кр╕Фр╕З error

### 3. р╕ер╕Ър╕ер╕╣р╕Бр╕Др╣Йр╕▓

1. р╣Др╕Ыр╕Чр╕╡р╣Ир╕лр╕Щр╣Йр╕▓ "р╕ер╕╣р╕Бр╕Др╣Йр╕▓" тЖТ р╕Бр╕Ф "р╕ер╕Ъ" р╕Чр╕╡р╣Ир╕ер╕╣р╕Бр╕Др╣Йр╕▓р╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕г
2. р╕Цр╣Йр╕▓р╕ер╕╣р╕Бр╕Др╣Йр╕▓р╕бр╕╡р╕нр╕нр╣Ар╕Фр╕нр╕гр╣М тЖТ р╕Ир╕░р╣Бр╕кр╕Фр╕З notification "р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕ер╕Ър╣Др╕Фр╣Й"
3. р╕Цр╣Йр╕▓р╕ер╕╣р╕Бр╕Др╣Йр╕▓р╣Др╕бр╣Ир╕бр╕╡р╕нр╕нр╣Ар╕Фр╕нр╕гр╣М тЖТ р╕Ир╕░р╕ер╕Ър╣Др╕Фр╣Й

### 4. р╕кр╣Ир╕Зр╕нр╕╡р╣Ар╕бр╕е (Bulk)

1. р╣Др╕Ыр╕Чр╕╡р╣Ир╕лр╕Щр╣Йр╕▓ "р╕ер╕╣р╕Бр╕Др╣Йр╕▓" тЖТ р╣Ар╕ер╕╖р╕нр╕Бр╕ер╕╣р╕Бр╕Др╣Йр╕▓р╕лр╕ер╕▓р╕вр╕гр╕▓р╕вр╕Бр╕▓р╕г
2. р╕Бр╕Ф "р╕кр╣Ир╕Зр╕нр╕╡р╣Ар╕бр╕е" р╣Гр╕Щ bulk actions
3. р╕Ир╕░р╕кр╣Ир╕Зр╕нр╕╡р╣Ар╕бр╕ер╣Гр╕лр╣Йр╕ер╕╣р╕Бр╕Др╣Йр╕▓р╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Фр╕Чр╕╡р╣Ир╣Ар╕ер╕╖р╕нр╕Б

---

## ЁЯУЭ р╕кр╕гр╕╕р╕Ы

CRUD р╕ер╕╣р╕Бр╕Др╣Йр╕▓р╕Щр╕╡р╣Йр╣Бр╕кр╕Фр╕Зр╣Гр╕лр╣Йр╣Ар╕лр╣Зр╕Щр╕Бр╕▓р╕г**р╕Ьр╕кр╕бр╕гр╕░р╕лр╕зр╣Ир╕▓р╕З Filament features р╕Бр╕▒р╕Ъ custom code** р╣Вр╕Фр╕в:

- **р╣Гр╕Кр╣Й Filament** р╕кр╕│р╕лр╕гр╕▒р╕Ъ UI р╣Бр╕ер╕░ CRUD р╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щ
- **р╣Ар╕Вр╕╡р╕вр╕Щ Custom Logic** р╕кр╕│р╕лр╕гр╕▒р╕Ъ business rules р╣Бр╕ер╕░ validation
- **р╣Ар╕Юр╕┤р╣Ир╕б Custom Actions** р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Яр╕╡р╣Ар╕Ир╕нр╕гр╣Мр╕Юр╕┤р╣Ар╕ир╕й
- **р╣Ар╕Юр╕┤р╣Ир╕б Custom Methods** р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕ер╕Вр╣Йр╕нр╕бр╕╣р╕е

р╕зр╕┤р╕Шр╕╡р╕Щр╕╡р╣Йр╕Чр╕│р╣Гр╕лр╣Йр╣Др╕Фр╣Йр╕Ыр╕гр╕░р╣Вр╕вр╕Кр╕Щр╣Мр╕Чр╕▒р╣Йр╕Зр╕кр╕нр╕Зр╕нр╕вр╣Ир╕▓р╕З:
- **р╣Ар╕гр╣Зр╕з** р╣Ар╕Юр╕гр╕▓р╕░р╣Гр╕Кр╣Й Filament components
- **р╕вр╕╖р╕Фр╕лр╕вр╕╕р╣Ир╕Щ** р╣Ар╕Юр╕гр╕▓р╕░р╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Ар╕Вр╕╡р╕вр╕Щ custom logic р╣Др╕Фр╣Й
